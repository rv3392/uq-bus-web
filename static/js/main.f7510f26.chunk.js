(this["webpackJsonpuq-bus-web"]=this["webpackJsonpuq-bus-web"]||[]).push([[0],{22:function(t,e,n){t.exports=n(32)},27:function(t,e,n){},32:function(t,e,n){"use strict";n.r(e);var a=n(11),i=n(7),r=n(13),s=n(14),o=n(17),u=n(0),c=n.n(u),l=n(19),h=n.n(l),p=(n(27),n(55)),m=n(57),g=n(59),d=n(53),f=n(56),b=n(52),v=n(54),E=function(t){function e(){var t,n;Object(a.a)(this,e);for(var i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];return(n=Object(r.a)(this,(t=Object(s.a)(e)).call.apply(t,[this].concat(o)))).state={rows:n.convertBuses(n.props.buses),initialRows:n.convertBuses(n.props.buses),classes:n.useStyles()},n}return Object(o.a)(e,t),Object(i.a)(e,[{key:"useStyles",value:function(){return{table:{minWidth:500}}}},{key:"convertBuses",value:function(t){for(var e=[],n=0;n<t.length;n++){var a=t[n],i={no:a.routeShortName,route:a.routeLongName,stop:a.stopName,time:a.time};e.push(i)}return e}},{key:"componentDidMount",value:function(){this.setState({rows:this.convertBuses(this.props.buses),initialRows:this.state.rows})}},{key:"componentWillReceiveProps",value:function(t){this.setState({rows:this.convertBuses(this.props.buses),initialRows:this.state.rows})}},{key:"getRows",value:function(){return this.state.rows.map((function(t){return c.a.createElement(b.a,null,c.a.createElement(g.a,null,t.no),c.a.createElement(g.a,null,t.route),c.a.createElement(g.a,null,t.stop),c.a.createElement(g.a,null,t.time))}))}},{key:"render",value:function(){return c.a.createElement(d.a,{component:v.a},c.a.createElement(p.a,{className:this.state.classes.table,size:"small","aria-label":"simple table"},c.a.createElement("colgroup",null,c.a.createElement("col",{style:{width:"5%"}}),c.a.createElement("col",{style:{width:"40%"}}),c.a.createElement("col",{style:{width:"40%"}}),c.a.createElement("col",{style:{width:"15%"}})),c.a.createElement(f.a,null,c.a.createElement(b.a,null,c.a.createElement(g.a,null),c.a.createElement(g.a,{align:"left"},"Route"),c.a.createElement(g.a,{align:"left"},"Stop"),c.a.createElement(g.a,{align:"left"},"Time"))),c.a.createElement(m.a,null,this.getRows())))}}]),e}(c.a.Component),S=function(){function t(e,n,i,r,s){var o=this;Object(a.a)(this,t),this.tripId=e,this.stopId=n,this.direction=r,this.time="Loading... ",this.trip="Loading... ",this.route="Loading...  ",this.routeLongName="Loading...  ",this.routeShortName="Loading...  ",this.stop="Loading...  ",this.stopName="Loading...  ",this.getTripPromise(this.tripId).then(function(t){return this.trip=t[0],this.getRoutePromise(t[0].route_id)}.bind(this)).then(function(t){this.route=t,this.routeLongName=t[0].route_long_name,this.routeShortName=t[0].route_short_name}.bind(this)).then(function(){this.time=i,s.stateUpdateCallback()}.bind(this)),this.getStopPromise(n).then(function(t){this.stop=t,this.stopName=t[0].stop_name}.bind(this)).then((function(){return s.stateUpdateCallback(o,o.direction)}))}return Object(i.a)(t,[{key:"getTripPromise",value:function(t){return fetch("http://uqbus.richal.tech/trip/trip_id/"+t+"/").then((function(t){return t.json()}))}},{key:"getRoutePromise",value:function(t){return fetch("http://uqbus.richal.tech/route/route_id/"+t+"/").then((function(t){return t.json()}))}},{key:"getStopPromise",value:function(t){return fetch("http://uqbus.richal.tech/stop/stop_id/"+t+"/").then((function(t){return t.json()}))}},{key:"getTripUpdatePromise",value:function(t){return fetch("http://uqbus.richal.tech/trip_update/trip_id/"+t+"/").then((function(t){return t.json()}))}},{key:"getStopTimeUpdate",value:function(t){return fetch("http://uqbus.richal.tech/stop_time_update/trip_update_id/"+t+"/").then((function(t){return t.json()}))}}]),t}(),y=n(58),w=["1853","1877","1878","1880","1883","1882"],B=function(t){function e(){var t,n;Object(a.a)(this,e);for(var i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];return(n=Object(r.a)(this,(t=Object(s.a)(e)).call.apply(t,[this].concat(o)))).state={departingBuses:[],arrivingBuses:[]},n}return Object(o.a)(e,t),Object(i.a)(e,[{key:"componentDidMount",value:function(){this.getBuses()}},{key:"stateUpdateCallback",value:function(t,e){var n=[t];"departing"===e?(n=this.state.departingBuses.concat(n),this.setState({departingBuses:n,arrivingBuses:this.state.arrivingBuses})):"arriving"===e&&(n=this.state.arrivingBuses.concat(n),this.setState({departingBuses:this.state.departingBuses,arrivingBuses:n})),this.forceUpdate()}},{key:"getBuses",value:function(){for(var t=this,e="",n=new Date,a=new Date(n.toLocaleString("en-US",{timezone:"Australia/Brisbane"})),i=a.getFullYear()+"-"+(a.getMonth()+1).toString().padStart(2,"0")+"-"+a.getDate().toString().padStart(2,"0"),r=a.getHours().toString().padStart(2,"0")+":"+a.getMinutes().toString().padStart(2,"0")+":"+a.getSeconds().toString().padStart(2,"0"),s=0;s<w.length;s++)e=s===w.length-1?e.toString()+w[s].toString():e.toString()+w[s].toString()+",";console.log(e),fetch("http://uqbus.richal.tech/stop_time?time="+i+" "+r+"&stop_id="+e).then((function(t){return t.json()})).then((function(e){e.forEach((function(e){var n="1882"!==e.stop_id?"departing":"arriving",a=new S(e.trip_id,e.stop_id,e.departure_time,n,t);console.log(a)}))}))}},{key:"render",value:function(){return c.a.createElement("div",{className:"BusTable"},c.a.createElement("h1",{align:"center"},"UQBus"),c.a.createElement("h2",{align:"center"},"UQ Lakes"),c.a.createElement(y.a,{container:!0,spacing:0,alignItems:"center",justify:"center"},c.a.createElement(y.a,{item:!0},c.a.createElement("h2",null,"Departures"),c.a.createElement(E,{app:this,buses:this.state.departingBuses}))),c.a.createElement(y.a,{container:!0,spacing:0,alignItems:"center",justify:"center"},c.a.createElement(y.a,{item:!0},c.a.createElement("h2",null,"Arrivals"),c.a.createElement(E,{app:this,buses:this.state.arrivingBuses}))))}}]),e}(c.a.Component);h.a.render(c.a.createElement(B,null),document.getElementById("root"))}},[[22,1,2]]]);
//# sourceMappingURL=main.f7510f26.chunk.js.map