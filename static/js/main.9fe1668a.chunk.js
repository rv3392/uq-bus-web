(this["webpackJsonpuq-bus-web"]=this["webpackJsonpuq-bus-web"]||[]).push([[0],{13:function(t,e,n){},14:function(t,e,n){"use strict";n.r(e);var r=n(6),a=n(4),i=n(7),u=n(1),o=n(2),s=n(0),l=n.n(s),c=n(5),h=n.n(c),p=(n(13),function(t){var e=t.buses;return l.a.createElement("table",null,l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"No."),l.a.createElement("th",null,"Route"),l.a.createElement("th",null,"Stop"),l.a.createElement("th",null,"Time"),l.a.createElement("th",null,"debug_stop_id"),l.a.createElement("th",null,"debug_trip_id"))),l.a.createElement("tbody",null,e.length>0?e.map((function(t,e){return l.a.createElement("tr",{key:e},l.a.createElement("td",null,t.routeShortName),l.a.createElement("td",null,t.routeLongName),l.a.createElement("td",null,t.stopName),l.a.createElement("td",null,t.time),l.a.createElement("td",null,t.stopId),l.a.createElement("td",null,t.tripId))})):l.a.createElement("tr",null,l.a.createElement("td",null,"Loading..."))))}),d=["1853","1877","1878","1880","1883","1882"],m=function(){function t(e,n,r,a,i){Object(u.a)(this,t),this.tripId=e,this.stopId=n,this.direction=a,this.time="Loading...  ",this.trip="Loading...  ",this.route="Loading...  ",this.routeLongName="Loading...  ",this.routeShortName="Loading...  ",this.stop="Loading...  ",this.stopName="Loading...  ",this.getTripPromise(this.tripId).then(function(t){return this.trip=t[0],this.getRoutePromise(t[0].route_id)}.bind(this)).then(function(t){this.route=t,this.routeLongName=t[0].route_long_name,this.routeShortName=t[0].route_short_name}.bind(this)).then(function(){this.time=r,i.stateUpdateCallback()}.bind(this)),this.getStopPromise(n).then(function(t){this.stop=t,this.stopName=t[0].stop_name}.bind(this)).then((function(){return i.stateUpdateCallback}))}return Object(o.a)(t,[{key:"getTripPromise",value:function(t){return fetch("http://uqbus.richal.tech/trip/trip_id/"+t+"/").then((function(t){return t.json()}))}},{key:"getRoutePromise",value:function(t){return fetch("http://uqbus.richal.tech/route/route_id/"+t+"/").then((function(t){return t.json()}))}},{key:"getStopPromise",value:function(t){return fetch("http://uqbus.richal.tech/stop/stop_id/"+t+"/").then((function(t){return t.json()}))}},{key:"getTripUpdatePromise",value:function(t){return fetch("http://uqbus.richal.tech/trip_update/trip_id/"+t+"/").then((function(t){return t.json()}))}},{key:"getStopTimeUpdate",value:function(t){return fetch("http://uqbus.richal.tech/stop_time_update/trip_update_id/"+t+"/").then((function(t){return t.json()}))}}]),t}(),g=function(t){function e(){var t,n;Object(u.a)(this,e);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(n=Object(r.a)(this,(t=Object(a.a)(e)).call.apply(t,[this].concat(o)))).state={departingBuses:[],arrivingBuses:[]},n}return Object(i.a)(e,t),Object(o.a)(e,[{key:"componentDidMount",value:function(){this.getBuses()}},{key:"stateUpdateCallback",value:function(){this.forceUpdate()}},{key:"getBusesForStop",value:function(t){var e=new Date,n=new Date(e.toLocaleString("en-US",{timezone:"Australia/Brisbane"})),r=n.getFullYear()+"-"+(n.getMonth()+1).toString().padStart(2,"0")+"-"+n.getDate().toString().padStart(2,"0"),a=n.getHours().toString().padStart(2,"0")+":"+n.getMinutes().toString().padStart(2,"0")+":"+n.getSeconds().toString().padStart(2,"0");return fetch("http://uqbus.richal.tech/stop_time/stop_id/"+t+"/current_time/"+r+" "+a+"/").then((function(t){return t.json()}))}},{key:"getBuses",value:function(){for(var t=this,e=[],n=[],r=[],a=[],i=0;i<d.length;i++)e=e.concat(this.getBusesForStop(d[i]));Promise.all(e).then((function(e){e.forEach((function(t){return n=n.concat(t)})),n.forEach((function(e){var n="1882"!==e.stop_id?"departing":"arriving",i=new m(e.trip_id,e.stop_id,e.departure_time,n,t);console.log(i),"departing"===n?r.push(i):a.push(i)})),t.setState({departingBuses:r,arrivingBuses:a})}))}},{key:"render",value:function(){return l.a.createElement("div",{className:"BusTable"},l.a.createElement("h2",null,"Departures"),l.a.createElement(p,{buses:this.state.departingBuses}),l.a.createElement("h2",null,"Arrivals"),l.a.createElement(p,{buses:this.state.arrivingBuses}))}}]),e}(l.a.Component);h.a.render(l.a.createElement(g,null),document.getElementById("root"))},8:function(t,e,n){t.exports=n(14)}},[[8,1,2]]]);
//# sourceMappingURL=main.9fe1668a.chunk.js.map